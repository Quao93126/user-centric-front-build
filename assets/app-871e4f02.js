import{r as i,j as e,T as r,P as m,B as C,M as R,a as W,S as L,b as p,A as y,W as me}from"./index-faf6d3d2.js";import{_ as Ce,d as pe,I as ye}from"./mapdata-2a7fe646.js";import{S as v,C as M}from"./searchbar-76d4fb11.js";import{C as je}from"./Container-01e4d7fb.js";import{G as l}from"./Grid-27181c0c.js";import{I as J,a as $}from"./ImageListItem-553a61ae.js";import{C as P}from"./Checkbox-c4517c2c.js";import"./OutlinedInput-4d845372.js";import"./react-is.production.min-a192e302.js";import"./isMuiElement-8ec8267a.js";const U={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:520,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function Se(){const[j,d]=i.useState(0),E=JSON.parse(sessionStorage.getItem("user")),[u,G]=i.useState([]),[c,H]=i.useState([]),S=i.useRef([]),b=i.useRef([]),N=i.useRef(0),V=()=>p.get(`${y}getallCountry`),X=t=>p.get(`${y}getAllCountryCityScore`,{params:{id:t}}),[q,O]=i.useState(!1),[k,K]=i.useState(""),[Q,Y]=i.useState([u]),[a,f]=i.useState([]),w=Object.values(a).filter(Boolean).length,Z=()=>O(!0),ee=()=>O(!1),te=t=>{K(t.target.value)},se=t=>{const s=u.find(o=>o.title===t),n=s?s.score:0;a[t]?d(o=>o-Number(n)):d(o=>o+Number(n)),f(o=>{const x={...o};return x[t]=!o[t],x})};i.useEffect(()=>{Y(u.filter(t=>t.title.toLowerCase().includes(k.toLowerCase())))},[k,u]);const[g,ie]=i.useState([]),oe=()=>p.get(`${y}getallCity`);i.useEffect(()=>{oe().then(t=>{ie(t.data.data)}).catch(()=>{console.log("failed")})},[]);const[ne,A]=i.useState(!1),[I,le]=i.useState(""),[re,ce]=i.useState(g),[h,B]=i.useState([]),D=Object.values(h).filter(Boolean).length,z=()=>A(!0),ae=()=>A(!1),de=t=>{le(t.target.value)},ue=t=>{let s="Not";Object.keys(M).forEach(n=>{M[n].cities.includes(t)&&(s=n)}),Object.keys(a).includes(s)?console.log("Country of the city has been checked already"):f(n=>{const o={...n};return o[s]=!n[s],o})},he=t=>{const s=g.find(o=>o.cityname===t),n=s?s.score:0;ue(t),h[t]?d(o=>o-Number(n)):d(o=>o+Number(n)),B(o=>{const x={...o};return x[t]=!o[t],x})};i.useEffect(()=>{ce(g.filter(t=>t.cityname.toLowerCase().includes(I.toLowerCase())))},[I,g]);const F=["#5eb3d8","#fedb76","#40d3b7","#f97b7f","#f496f0","#ec7e7f"],T=Object.values(u).map(t=>t.title);let _=0;const xe=({countryName:t})=>{const s=!!a[t];let n="#93BED4";return s?(n=F[_%F.length],_+=1):T.includes(t)&&(n="#d9d9f2"),{fill:n,stroke:"black",strokeWidth:1,strokeOpacity:.2,cursor:"pointer"}},fe=t=>{T.includes(t.countryName)&&f(s=>{const n={...s};return n[t.countryName]=!s[t.countryName],n})};i.useEffect(()=>{V().then(t=>{G(t.data.data)}).catch(()=>{console.log("failed")}),X(E.id).then(t=>{H(t.data.data)}).catch(()=>{console.log("failed score")})},[]),i.useEffect(()=>{c.length>0&&c[0].country!==""&&f(JSON.parse(c[0].country)),c.length>0&&c[0].city!==""&&B(JSON.parse(c[0].city)),c.length>0&&c[0].score!==""&&d(JSON.parse(c[0].score))},[c]),i.useEffect(()=>{S.current=a},[a]),i.useEffect(()=>{b.current=h},[h]),i.useEffect(()=>{N.current=j},[j]);const ge=(t,s,n,o)=>p.post(`${y}addCountryCityScore`,{a:t,b:s,c:n,d:o});return i.useEffect(()=>()=>{let t="";Object.keys(S.current).length>0&&(t=JSON.stringify(S.current));let s="";Object.keys(b.current).length>0&&(s=JSON.stringify(b.current)),ge(E.id,t,s,N.current).then(()=>{console.log("Adding Country City and Score SUCCESS!!!")}).catch(()=>{console.log("failed")})},[]),e.jsxs(je,{maxWidth:"xl",children:[e.jsx(l,{container:!0,spacing:3,justifyContent:"center",alignItems:"center",marginTop:6,children:e.jsxs(l,{item:!0,style:{position:"relative"},children:[e.jsx("img",{alt:"icon",src:"/assets/images/travelscore.png",style:{width:"233px",height:"200px"}}),e.jsxs(l,{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-34%, -34%)",textAlign:"center"},children:[e.jsx(r,{style:{fontSize:"15px",color:"#474A5D",fontWeight:400},children:"Travel Score"}),e.jsx(r,{style:{fontSize:"43px",color:"#FA479D",fontWeight:600},children:j})]})]})}),e.jsxs(l,{container:!0,spacing:3,marginTop:2,sx:{display:"flex",justifyContent:"right"},children:[e.jsx(l,{item:!0,xs:6,md:6,lg:6,children:e.jsx(m,{sx:{backgroundColor:"#FB8D334D"},children:e.jsx(C,{fullWidth:!0,sx:{alignItems:"left",justifyContent:"left"},startIcon:e.jsx("img",{src:"/assets/icons/glass/ic_glass_country.png",alt:"icon",style:{marginRight:8,width:46,height:46}}),onClick:Z,children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(r,{sx:{color:"#E98A1B",fontSize:"18px"},children:w}),e.jsx(r,{sx:{color:"#474A5D",fontSize:"14px"},children:"Countries"})]})})})}),e.jsx(l,{item:!0,xs:6,md:6,lg:6,children:e.jsx(m,{sx:{backgroundColor:"#0071CE4D"},children:e.jsx(C,{fullWidth:!0,sx:{alignItems:"left",justifyContent:"left"},startIcon:e.jsx("img",{src:"/assets/icons/glass/ic_glass_city.png",alt:"icon",style:{marginRight:8,width:46,height:46}}),onClick:z,children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(r,{sx:{color:"#0B70EC",fontSize:"18px"},children:D}),e.jsx(r,{sx:{color:"#474A5D",fontSize:"14px"},children:"Cities"})]})})})})]}),e.jsx(R,{open:q,onClose:ee,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(W,{sx:U,children:[e.jsx(l,{item:!0,id:"modal-modal-title",xs:12,md:12,lg:12,children:e.jsx(m,{sx:{backgroundColor:"#FB8D334D"},children:e.jsx(C,{fullWidth:!0,sx:{alignItems:"left",justifyContent:"left"},startIcon:e.jsx("img",{src:"/assets/icons/glass/ic_glass_country.png",alt:"icon",style:{marginRight:8,width:46,height:46}}),children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(r,{sx:{color:"#E98A1B",fontSize:"18px"},children:w}),e.jsx(r,{sx:{color:"#474A5D",fontSize:"14px"},children:"Countries"})]})})})}),e.jsx(v,{filterName:k,onFilterName:te}),e.jsx(L,{children:e.jsx(J,{sx:{width:450,height:300},cols:4,rowHeight:82,children:Q.map((t,s)=>e.jsxs($,{sx:{marginTop:2},children:[e.jsx("img",{alt:`${t.value}`,src:`https://purecatamphetamine.github.io/country-flag-icons/3x2/${t.value}.svg`,style:{width:"100%",height:"auto",cursor:"pointer"}}),e.jsxs(r,{sx:{fontSize:10,color:"black"},children:[e.jsx(P,{checked:!!a[t.title],onChange:()=>se(t.title),sx:{padding:0},size:"small"}),t.title]})]},s))})})]})}),e.jsx(l,{container:!0,spacing:3,justifyContent:"center",alignItems:"center",marginTop:6,children:e.jsx(Ce,{richInteraction:!0,backgroundColor:"white",borderColor:"white",color:"#93BED4",tooltipBgColor:"#31323f",size:"xl",data:pe,styleFunction:xe,onClickFunction:fe})}),e.jsx(R,{open:ne,onClose:ae,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(W,{sx:U,children:[e.jsx(l,{item:!0,id:"modal-modal-title",xs:12,md:12,lg:12,children:e.jsx(m,{sx:{backgroundColor:"#0071CE4D"},children:e.jsx(C,{fullWidth:!0,sx:{alignItems:"left",justifyContent:"left"},startIcon:e.jsx("img",{src:"/assets/icons/glass/ic_glass_city.png",alt:"icon",style:{marginRight:8,width:46,height:46}}),onClick:z,children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(r,{sx:{color:"#0B70EC",fontSize:"18px"},children:D}),e.jsx(r,{sx:{color:"#474A5D",fontSize:"14px"},children:"Cities"})]})})})}),e.jsx(v,{filterName:I,onFilterName:de}),e.jsx(L,{children:e.jsx(J,{sx:{width:450,height:300,backgroundColor:"black",paddingX:2},cols:2,gap:20,rowHeight:82,children:re.map((t,s)=>e.jsxs($,{sx:{marginTop:2},children:[e.jsx("img",{src:"/assets/images/city.jpg",alt:"Background",style:{width:"90%",height:"100%",cursor:"pointer"}}),e.jsx(ye,{title:e.jsxs(r,{sx:{fontSize:10,color:"white"},children:[e.jsx(P,{checked:!!h[t.cityname],onChange:()=>he(t.cityname),sx:{padding:0},size:"small"}),t.cityname]}),position:"below"})]},s))})})]})})]})}function ze(){return e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsx("title",{children:" Dashboard | Travel Bio"})}),e.jsx(Se,{})]})}export{ze as default};
